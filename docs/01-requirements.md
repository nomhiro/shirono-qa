# shiro Assistant 要件定義書

**バージョン**: 2.1  
**作成日**: 2025年6月25日  
**最終更新**: 2025年7月4日  
**作成者**: システム開発担当者  

## 1. プロジェクト概要

### 1.1 目的
転職後の個人的な技術支援サイト「shiro Assistant」を構築し、元職場の同僚からの技術的な質問・検証依頼・調査依頼に対応する。

### 1.2 スコープ
- IT、AI、Azureに関する技術的な質問・検証依頼・調査依頼の受付と対応
- 元職場の同僚20名程度を対象とした限定的なサービス
- 投稿種別：質問、検証依頼、調査依頼、技術相談など

### 1.3 制約事項
- 元職場の業務に関わる機密情報の投稿は禁止
- 異なるAzureテナント環境での運用のため独自認証を使用
- 会社のMicrosoftアカウントや個人アカウントの使用は禁止。本システム用の独自アカウントを使用する。

### 1.4 運用期間
- **期間**: 1年間
- **サービス終了時**: データエクスポート機能を提供

## 2. ステークホルダー

### 2.1 主要ステークホルダー
- **運用責任者**: システム開発者（管理者権限）
- **利用者**: 元職場の同僚（最大20名程度）

### 2.2 役割と責任
| 役割 | 責任範囲 |
|------|----------|
| 運用責任者 | システム運用・保守、ユーザー管理、質問への回答 |
| 利用者 | 技術的質問・検証依頼・調査依頼の投稿、適切な利用 |

## 3. 機能要件

### 3.1 ユーザー管理機能

#### 3.1.1 ユーザー登録・認証
- **概要**: 管理者による事前ユーザー登録と独自認証システム
- **詳細**:
  - 管理者が20名程度のユーザーを事前登録
  - ユーザー名・パスワードによる独自認証
  - パスワードリセット機能
  - セッション管理（6時間タイムアウト）

#### 3.1.2 グループ管理
- **概要**: ユーザーのグループ分けと権限管理
- **詳細**:
  - 管理者がグループを定義・管理
  - ユーザーをグループに割り当て
  - グループ内ユーザーは同グループの投稿を参照可能
  - 管理者は全投稿を参照可能

#### 3.1.3 ユーザー権限
| 権限レベル   | 機能                                       |
| ------------ | ------------------------------------------ |
| 一般ユーザー | 投稿、同グループ内投稿参照、コメント投稿   |
| 管理者       | 全機能利用可能、ユーザー管理、グループ管理 |

### 3.2 投稿管理機能

#### 3.2.1 投稿機能
- **概要**: ユーザーが技術的な質問・検証依頼・調査依頼を投稿
- **投稿可能な内容**:
  - 技術的な質問（使い方、トラブルシューティングなど）
  - 検証依頼（「○○が動作するか確認してもらえますか」など）
  - 調査依頼（「○○の最新情報を調べてもらえますか」など）
  - IT、AI、Azureに関する相談事項
- **詳細**:
  - タイトル（必須、100文字以内）
  - 内容（必須、10,000文字以内）
  - 添付ファイル（任意、最大1GB/ファイル）
  - 優先度設定（高・中・低、デフォルト：中）
  - 管理者による手動タグ付け

#### 3.2.2 投稿ステータス管理
- **ステータス一覧**:
  - 未回答：投稿直後の初期状態
  - 回答済み：管理者が回答を投稿した状態
  - 解決済み：投稿者が解決済みとマークした状態
  - 却下：管理者が投稿を却下した状態
  - クローズ：運用終了等で投稿を終了した状態

#### 3.2.3 添付ファイル管理
- **対応形式**: PDF、画像（JPG、PNG、GIF）、Officeファイル（Word、Excel、PowerPoint）、プログラムファイル（各種拡張子）
- **制限事項**:
  - 1ファイルあたり最大1GB
  - 1投稿あたりファイル数5個まで
  - Azure Blob Storageに永続保存

### 3.3 回答・コメント機能

#### 3.3.1 回答機能
- **概要**: 管理者が投稿に対して回答を提供
- **詳細**:
  - 回答内容（必須、10,000文字以内）
  - 添付ファイル対応（投稿と同様）
  - 回答投稿時にステータスを「回答済み」に更新

#### 3.3.2 コメント機能
- **概要**: 投稿・回答に対する追加コメント
- **詳細**:
  - 投稿者・管理者ともにコメント投稿可能
  - コメント内容（必須、1,000文字以内）
  - 添付ファイル対応
  - 階層構造なし（フラットな時系列表示）

### 3.4 検索・一覧機能

#### 3.4.1 投稿一覧
- **概要**: 投稿の一覧表示と検索機能
- **表示項目**:
  - 投稿タイトル
  - 投稿者
  - 投稿日時
  - ステータス
  - 優先度
  - タグ
  - 最終更新日時

#### 3.4.2 検索機能
- **検索条件**:
  - キーワード検索（タイトル・本文）
  - ステータス絞り込み
  - 優先度絞り込み
  - タグ絞り込み
  - 投稿者絞り込み
  - 投稿日期間絞り込み

#### 3.4.3 ソート機能
- 投稿日時（昇順・降順）
- 最終更新日時（昇順・降順）
- 優先度（高→低、低→高）

### 3.5 検索機能（将来拡張）

#### 3.5.1 基本検索機能
- **キーワード検索**: タイトル・本文での全文検索
- **フィルタリング**: ステータス、優先度、投稿者での絞り込み
- **ソート機能**: 日付、優先度での並び替え

#### 3.5.2 将来の検索機能拡張
- **タグ検索**: 手動タグによる分類検索
- **類似投稿検索**: 関連する投稿の自動提案
- **詳細検索**: 複数条件を組み合わせた高度な検索

### 3.6 通知機能

#### 3.6.1 メール通知
- **通知対象者**: 投稿者と管理者
- **通知タイミング**:
  - 投稿時：管理者に通知
  - 回答投稿時：投稿者に通知
  - コメント追加時：投稿者と管理者に通知
  - 解決済みマーク時：管理者と投稿者に通知
  - 却下時：管理者と投稿者に通知

#### 3.6.2 通知内容
- 件名：[shiro Assistant] アクション内容
- 本文：投稿タイトル、投稿者、リンクURL
- HTML形式での送信
- nomhiro1204@gmail.comを送信元アドレスとする

## 4. 非機能要件

### 4.1 性能要件
- **レスポンス時間**: 一般的な操作で3秒以内
- **同時接続数**: 最大20ユーザー
- **ファイルアップロード**: 1GBファイルで10分以内

### 4.2 可用性要件
- **稼働率**: 99%以上（月間）
- **メンテナンス時間**: 月1回、2時間以内

### 4.3 セキュリティ要件
- **認証**: 独自アカウント認証（セッション管理）
- **セッション管理**: 
  - セッションタイムアウト: 6時間
  - セッションIDの定期更新
  - ログアウト時のセッション破棄
- **パスワードポリシー**:
  - 最小文字数: 8文字以上
  - 英数字必須（英字・数字の両方を含む）
  - 記号必須（!@#$%^&*等の特殊文字を含む）
  - パスワードハッシュ化（bcrypt使用）
- **通信**: HTTPS必須
- **データ保護**: 保存データの暗号化
- **アクセス制御**: グループベースのアクセス制御
- **環境変数管理**: App Serviceの環境変数設定（開発時は.env.local）

### 4.4 ユーザビリティ要件
- **レスポンシブデザイン**: モバイル・タブレット・PC対応
- **アクセシビリティ**: WCAG 2.1 AA準拠
- **ライトモード固定**: ダークモード設定に関わらず常にライトモードで表示

### 4.5 運用要件
- **運用期間**: 1年間
- **ログ保存**: 3ヶ月間
- **監視**: Azure Monitor による監視

## 5. 制約・リスク

### 5.1 技術的制約
- Azure App Service の制約事項
- Azure Functions の実行時間制限
- Cosmos DB の RU制限
- Cosmos DB ベクター検索の性能制限
- text-embedding-3-large の利用制限（1分あたりのリクエスト数）

### 5.2 運用リスク
- 単一運用者によるリスク
- 機密情報投稿のリスク
- 1年後のデータ移行・削除

### 5.3 対応策
- 詳細な運用マニュアルの作成
- 利用規約の明確化
- データエクスポート機能の実装

## 6. 成功基準

### 6.1 定量的指標
- **利用者数**: 15名以上の活発な利用者
- **投稿数**: 月間20件以上の投稿
- **回答率**: 90%以上の投稿に対する回答
- **解決率**: 80%以上の投稿が解決済みとなる

### 6.2 定性的指標
- 利用者からの満足度フィードバック
- システムの安定運用
- セキュリティインシデントの発生なし